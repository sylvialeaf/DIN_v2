# ç‰¹å¾å·¥ç¨‹è¯¦è§£ (FEATURES.md)

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»é¡¹ç›®ä¸­çš„ç‰¹å¾å·¥ç¨‹è®¾è®¡ï¼ŒåŒ…æ‹¬ç‰¹å¾å®šä¹‰ã€å¤„ç†æ–¹å¼ã€ä»¥åŠåœ¨ä¸åŒæ¨¡å‹ä¸­çš„åº”ç”¨ã€‚

## ğŸ“‹ ç›®å½•

1. [ç‰¹å¾æ€»è§ˆ](#ç‰¹å¾æ€»è§ˆ)
2. [ç”¨æˆ·ç‰¹å¾](#ç”¨æˆ·ç‰¹å¾)
3. [ç‰©å“ç‰¹å¾](#ç‰©å“ç‰¹å¾)
4. [åºåˆ—ç‰¹å¾](#åºåˆ—ç‰¹å¾)
5. [æ—¶é—´ç‰¹å¾](#æ—¶é—´ç‰¹å¾)
6. [ç»Ÿè®¡ç‰¹å¾](#ç»Ÿè®¡ç‰¹å¾)
7. [ç‰¹å¾åµŒå…¥è®¾è®¡](#ç‰¹å¾åµŒå…¥è®¾è®¡)
8. [ml-100k vs ml-1m å·®å¼‚](#ml-100k-vs-ml-1m-å·®å¼‚)

---

## ç‰¹å¾æ€»è§ˆ

### ç‰¹å¾çŸ©é˜µ

| ç‰¹å¾ç±»å‹ | ç‰¹å¾å | æ•°æ®ç±»å‹ | ç»´åº¦ | æ¨¡å‹ä½¿ç”¨ |
|----------|--------|----------|------|----------|
| ç”¨æˆ·ç”»åƒ | user_id | ID | 1 | åµŒå…¥å±‚ |
| | user_age | ç±»åˆ« | 7æ¡¶ | åµŒå…¥å±‚ |
| | user_gender | ç±»åˆ« | 2ç±» | åµŒå…¥å±‚ |
| | user_occupation | ç±»åˆ« | 21ç±» | åµŒå…¥å±‚ |
| ç‰©å“å±æ€§ | item_id | ID | 1 | åµŒå…¥å±‚ |
| | item_genre | ç±»åˆ« | 19ç±» | åµŒå…¥å±‚ |
| | item_year | ç±»åˆ« | 7æ¡¶ | åµŒå…¥å±‚ |
| åºåˆ—ç‰¹å¾ | item_seq | åºåˆ— | L | æ³¨æ„åŠ›/RNN |
| | history_genres | åºåˆ— | L | æ³¨æ„åŠ› |
| | history_years | åºåˆ— | L | æ³¨æ„åŠ› |
| æ—¶é—´ç‰¹å¾ | time_hour | ç±»åˆ« | 7æ¡¶ | åµŒå…¥å±‚ |
| | time_dow | ç±»åˆ« | 7ç±» | åµŒå…¥å±‚ |
| | time_weekend | äºŒå€¼ | 2ç±» | åµŒå…¥å±‚ |
| ç»Ÿè®¡ç‰¹å¾ | user_activity | ç±»åˆ« | 6æ¡¶ | åµŒå…¥å±‚ |
| | item_popularity | ç±»åˆ« | 6æ¡¶ | åµŒå…¥å±‚ |

### ç‰¹å¾æµå‘å›¾

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚              åŸå§‹æ•°æ®                    â”‚
                    â”‚  u.data / u.user / u.item / ratings.dat â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚           FeatureProcessor          â”‚
                    â”‚  (feature_engineering.py)           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼             â–¼               â–¼               â–¼             â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ç”¨æˆ·ç‰¹å¾  â”‚  â”‚ç‰©å“ç‰¹å¾   â”‚  â”‚ åºåˆ—ç‰¹å¾   â”‚  â”‚æ—¶é—´ç‰¹å¾   â”‚  â”‚ç»Ÿè®¡ç‰¹å¾   â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
        â”‚            â”‚              â”‚              â”‚             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚        RichFeatureDataset     â”‚
                    â”‚      (data_loader.py)         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         æ¨¡å‹è¾“å…¥ (batch)       â”‚
                    â”‚  DIN / GRU4Rec / SASRec / ... â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç”¨æˆ·ç‰¹å¾

### 1. user_id
- **ç±»å‹**: å”¯ä¸€æ ‡è¯†ç¬¦
- **å¤„ç†**: ç›´æ¥åµŒå…¥
- **ç»´åº¦**: ml-100k: 943, ml-1m: 6040
- **åµŒå…¥ç»´åº¦**: 16 (feature_embedding_dim)

### 2. user_age (å¹´é¾„åˆ†æ¡¶)
- **åŸå§‹æ•°æ®**: æ•´æ•°å¹´é¾„ (1-100)
- **åˆ†æ¡¶ç­–ç•¥**:

| æ¡¶ç¼–å· | å¹´é¾„èŒƒå›´ | å«ä¹‰ |
|--------|----------|------|
| 1 | <18 | æœªæˆå¹´ |
| 2 | 18-24 | å¤§å­¦ç”Ÿ/åˆšæ¯•ä¸š |
| 3 | 25-34 | é’å¹´ |
| 4 | 35-44 | ä¸­é’å¹´ |
| 5 | 45-54 | ä¸­å¹´ |
| 6 | 55-64 | ä¸­è€å¹´ |
| 7 | 65+ | è€å¹´ |

```python
# ä»£ç å®ç°
AGE_BINS = [0, 18, 25, 35, 45, 55, 65, 100]
AGE_LABELS = ['<18', '18-24', '25-34', '35-44', '45-54', '55-64', '65+']
user_df['age_bucket'] = pd.cut(user_df['age'], bins=AGE_BINS, labels=False) + 1
```

**è®¾è®¡ç†ç”±**: å¹´é¾„åˆ†æ¡¶å¯ä»¥ï¼š
- å‡å°‘ç¨€ç–æ€§ï¼ˆåŸå§‹å¹´é¾„æœ‰è¿‘100ä¸ªå–å€¼ï¼‰
- æ•æ‰å¹´é¾„æ®µçš„è§‚å½±åå¥½å·®å¼‚
- æå‡æ¨¡å‹æ³›åŒ–èƒ½åŠ›

### 3. user_gender (æ€§åˆ«)
- **ç¼–ç **: M=1, F=2
- **ml-100k åˆ†å¸ƒ**: ç”·æ€§ 670 (71%), å¥³æ€§ 273 (29%)
- **ml-1m åˆ†å¸ƒ**: ç”·æ€§ 4331 (71.7%), å¥³æ€§ 1709 (28.3%)

### 4. user_occupation (èŒä¸š)
- **ç±»åˆ«æ•°**: 21 ç§èŒä¸š
- **èŒä¸šåˆ—è¡¨**:
```python
OCCUPATIONS = [
    'administrator', 'artist', 'doctor', 'educator', 'engineer',
    'entertainment', 'executive', 'healthcare', 'homemaker', 'lawyer',
    'librarian', 'marketing', 'none', 'other', 'programmer',
    'retired', 'salesman', 'scientist', 'student', 'technician', 'writer'
]
```

**æ³¨æ„**: ml-1m çš„èŒä¸šç¼–ç ä¸ ml-100k ä¸åŒï¼Œéœ€è¦å•ç‹¬å¤„ç†ã€‚

---

## ç‰©å“ç‰¹å¾

### 1. item_id
- **ç±»å‹**: å”¯ä¸€æ ‡è¯†ç¬¦
- **å¤„ç†**: åµŒå…¥å±‚ï¼Œpadding_idx=0
- **ç»´åº¦**: ml-100k: 1682, ml-1m: 3952
- **åµŒå…¥ç»´åº¦**: 64 (item_embedding_dim)

### 2. item_genre (ç”µå½±ç±»å‹)
- **ç±»åˆ«æ•°**: 19 ç§ç±»å‹
- **å¤„ç†æ–¹å¼**: å–ç¬¬ä¸€ä¸ªæ ‡è®°ä¸º1çš„ç±»å‹ä½œä¸ºä¸»ç±»å‹

```python
GENRES = [
    'unknown', 'Action', 'Adventure', 'Animation', "Children's", 
    'Comedy', 'Crime', 'Documentary', 'Drama', 'Fantasy',
    'Film-Noir', 'Horror', 'Musical', 'Mystery', 'Romance', 
    'Sci-Fi', 'Thriller', 'War', 'Western'
]

def get_primary_genre(row):
    for i, genre in enumerate(GENRES):
        if row[genre] == 1:
            return i + 1  # ä»1å¼€å§‹ï¼Œ0ç•™ç»™padding
    return 0
```

**å¤šæ ‡ç­¾å¤„ç†**: ä¸€éƒ¨ç”µå½±å¯èƒ½æœ‰å¤šä¸ªç±»å‹ï¼Œä½†ä¸ºç®€åŒ–å¤„ç†åªå–ä¸»ç±»å‹ã€‚

### 3. item_year (å‘å¸ƒå¹´ä»£)
- **åŸå§‹æ•°æ®**: å‘å¸ƒæ—¥æœŸå­—ç¬¦ä¸² (å¦‚ "01-Jan-1995")
- **åˆ†æ¡¶ç­–ç•¥**:

| æ¡¶ç¼–å· | å¹´ä»£èŒƒå›´ | è¯´æ˜ |
|--------|----------|------|
| 0 | æœªçŸ¥ | ç¼ºå¤±å€¼ |
| 1 | <1950 | ç»å…¸è€ç‰‡ |
| 2 | 1950-1959 | 50å¹´ä»£ |
| 3 | 1960-1969 | 60å¹´ä»£ |
| 4 | 1970-1979 | 70å¹´ä»£ |
| 5 | 1980-1989 | 80å¹´ä»£ |
| 6 | 1990+ | 90å¹´ä»£åŠä»¥å |

```python
def extract_year(date_str):
    if pd.isna(date_str):
        return 0
    # æ”¯æŒå¤šç§æ ¼å¼: "01-Jan-1995", "1995-01-01", "1995"
    import re
    match = re.search(r'(19|20)\d{2}', str(date_str))
    if match:
        return int(match.group())
    return 0

def year_bucket(year):
    if year == 0:
        return 0
    elif year < 1950:
        return 1
    elif year < 1960:
        return 2
    # ... ä¾æ¬¡ç±»æ¨
```

---

## åºåˆ—ç‰¹å¾

### 1. item_seq (å†å²ç‰©å“åºåˆ—)
- **ç»´åº¦**: [batch_size, max_seq_length]
- **å¤„ç†**: å·¦ä¾§ paddingï¼ˆ0ï¼‰ï¼Œä¿ç•™æœ€è¿‘çš„äº¤äº’
- **é•¿åº¦**: å®éªŒä¸­æµ‹è¯• 20, 50, 100, 150

```python
# æ„å»ºç¤ºä¾‹
if len(history) < max_seq_length:
    padding_len = max_seq_length - len(history)
    history = [0] * padding_len + history  # å·¦ä¾§padding
```

### 2. history_genres (å†å²ç‰©å“ç±»å‹åºåˆ—)
- **ç»´åº¦**: [batch_size, max_seq_length]
- **ç”¨é€”**: åœ¨ DIN æ³¨æ„åŠ›ä¸­ä¸ç›®æ ‡ç‰©å“ç±»å‹äº¤äº’

### 3. history_years (å†å²ç‰©å“å¹´ä»£åºåˆ—)
- **ç»´åº¦**: [batch_size, max_seq_length]
- **ç”¨é€”**: æ•æ‰ç”¨æˆ·å¯¹ä¸åŒå¹´ä»£ç”µå½±çš„åå¥½

### 4. item_seq_mask (æœ‰æ•ˆä½ç½®æ©ç )
- **ç»´åº¦**: [batch_size, max_seq_length]
- **å€¼**: 0=padding, 1=æœ‰æ•ˆ
- **ç”¨é€”**: æ³¨æ„åŠ›è®¡ç®—æ—¶å±è”½ padding ä½ç½®

---

## æ—¶é—´ç‰¹å¾

### 1. time_hour (å°æ—¶åˆ†æ¡¶)
- **åŸå§‹æ•°æ®**: Unix timestamp
- **åˆ†æ¡¶ç­–ç•¥**:

| æ¡¶ç¼–å· | å°æ—¶èŒƒå›´ | æ—¶æ®µ |
|--------|----------|------|
| 0 | 0-5 | å‡Œæ™¨ |
| 1 | 6-8 | æ—©æ™¨ |
| 2 | 9-11 | ä¸Šåˆ |
| 3 | 12-13 | ä¸­åˆ |
| 4 | 14-17 | ä¸‹åˆ |
| 5 | 18-20 | å‚æ™š |
| 6 | 21-23 | æ™šé—´ |

```python
def get_hour_bucket(hour):
    if hour < 6:
        return 0  # å‡Œæ™¨
    elif hour < 9:
        return 1  # æ—©æ™¨
    elif hour < 12:
        return 2  # ä¸Šåˆ
    elif hour < 14:
        return 3  # ä¸­åˆ
    elif hour < 18:
        return 4  # ä¸‹åˆ
    elif hour < 21:
        return 5  # å‚æ™š
    else:
        return 6  # æ™šé—´
```

### 2. time_dow (æ˜ŸæœŸå‡ )
- **å€¼**: 1-7 (å‘¨ä¸€åˆ°å‘¨æ—¥)
- **ç”¨é€”**: æ•æ‰å‘¨å†…è§‚å½±æ¨¡å¼

### 3. time_weekend (æ˜¯å¦å‘¨æœ«)
- **å€¼**: 0=å·¥ä½œæ—¥, 1=å‘¨æœ«
- **ç”¨é€”**: äºŒå€¼ç‰¹å¾ï¼Œç®€åŒ–å‘¨æ¨¡å¼

---

## ç»Ÿè®¡ç‰¹å¾

### 1. user_activity (ç”¨æˆ·æ´»è·ƒåº¦)
- **è®¡ç®—**: ç”¨æˆ·å†å²äº¤äº’æ¬¡æ•°
- **åˆ†æ¡¶**: 6 ä¸ªç­‰çº§

```python
def get_user_activity_level(count):
    if count < 20:
        return 1  # è½»åº¦ç”¨æˆ·
    elif count < 50:
        return 2  # æ™®é€šç”¨æˆ·
    elif count < 100:
        return 3  # æ´»è·ƒç”¨æˆ·
    elif count < 200:
        return 4  # é«˜åº¦æ´»è·ƒ
    elif count < 500:
        return 5  # è¶…çº§æ´»è·ƒ
    else:
        return 6  # é¡¶çº§ç”¨æˆ·
```

### 2. item_popularity (ç‰©å“çƒ­åº¦)
- **è®¡ç®—**: ç‰©å“è¢«äº¤äº’æ¬¡æ•°
- **åˆ†æ¡¶**: 6 ä¸ªç­‰çº§

```python
def get_item_popularity_level(count):
    if count < 10:
        return 1  # å†·é—¨
    elif count < 50:
        return 2  # å°ä¼—
    elif count < 100:
        return 3  # æ™®é€š
    elif count < 200:
        return 4  # çƒ­é—¨
    elif count < 500:
        return 5  # çˆ†æ¬¾
    else:
        return 6  # è¶…çº§çˆ†æ¬¾
```

---

## ç‰¹å¾åµŒå…¥è®¾è®¡

### åµŒå…¥ç»´åº¦é…ç½®

```python
# models.py ä¸­çš„é…ç½®
item_embedding_dim = 64      # ç‰©å“ ID åµŒå…¥
feature_embedding_dim = 16   # å…¶ä»–ç‰¹å¾åµŒå…¥

# å„ç‰¹å¾åµŒå…¥
self.item_embedding = nn.Embedding(num_items + 1, 64, padding_idx=0)
self.user_embedding = nn.Embedding(num_users + 1, 16)
self.age_embedding = nn.Embedding(10, 16)
self.gender_embedding = nn.Embedding(3, 16)
self.occupation_embedding = nn.Embedding(25, 16)
self.genre_embedding = nn.Embedding(20, 16, padding_idx=0)
self.year_embedding = nn.Embedding(8, 16, padding_idx=0)
```

### å¤šå­—æ®µåµŒå…¥ (MultiFieldEmbedding)

```python
class MultiFieldEmbedding(nn.Module):
    """
    å°†å¤šä¸ªç±»åˆ«ç‰¹å¾æ˜ å°„åˆ°åŒä¸€åµŒå…¥ç©ºé—´ï¼Œç„¶åæ‹¼æ¥æˆ–æ±‚å’Œ
    """
    def __init__(self, field_dims, embedding_dim, mode='concat'):
        # mode: 'concat' æ‹¼æ¥ | 'sum' æ±‚å’Œ
        self.embeddings = nn.ModuleDict({
            name: nn.Embedding(dim + 1, embedding_dim, padding_idx=0)
            for name, dim in field_dims.items()
        })
```

### DIN ä¸­çš„ç‰¹å¾èåˆ

```python
# åºåˆ—ç‰¹å¾ç»´åº¦ = item_emb + genre_emb + year_emb
seq_feature_dim = 64 + 16 + 16 = 96

# MLP è¾“å…¥ç»´åº¦è®¡ç®—
mlp_input_dim = (
    seq_feature_dim +           # ç”¨æˆ·å…´è¶£å‘é‡ (96)
    seq_feature_dim +           # ç›®æ ‡ç‰©å“è¡¨ç¤º (96)
    feature_embedding_dim +     # ç”¨æˆ· ID åµŒå…¥ (16)
    feature_embedding_dim * 4 + # ç”¨æˆ·ç‰¹å¾ (64)
    feature_embedding_dim * 3 + # ç‰©å“ç‰¹å¾ (48)
    feature_embedding_dim * 3   # æ—¶é—´ç‰¹å¾ (48)
) = 368
```

---

## ml-100k vs ml-1m å·®å¼‚

| æ–¹é¢ | ml-100k | ml-1m |
|------|---------|-------|
| **äº¤äº’æ•°** | 100,000 | 1,000,209 |
| **ç”¨æˆ·æ•°** | 943 | 6,040 |
| **ç‰©å“æ•°** | 1,682 | 3,952 |
| **ç¨€ç–åº¦** | 93.7% | 95.8% |
| **ç”¨æˆ·ç‰¹å¾æ–‡ä»¶** | u.user (ç®¡é“åˆ†éš”) | users.dat (åŒå†’å·åˆ†éš”) |
| **ç‰©å“ç‰¹å¾æ–‡ä»¶** | u.item (19ä¸ªgenreåˆ—) | movies.dat (genreå­—ç¬¦ä¸²) |
| **è¯„åˆ†æ–‡ä»¶** | u.data (åˆ¶è¡¨ç¬¦) | ratings.dat (åŒå†’å·) |
| **èŒä¸šç¼–ç ** | å­—ç¬¦ä¸² â†’ æ˜ å°„ | æ•°å­—ç¼–ç  |
| **genre æ ¼å¼** | 19ä¸ª0/1åˆ— | ç®¡é“åˆ†éš”å­—ç¬¦ä¸² |

### æ•°æ®åŠ è½½ä»£ç å·®å¼‚

```python
# ml-100k
if dataset_name == 'ml-100k':
    df = pd.read_csv(file_path, sep='\t', names=['user_id', 'item_id', 'rating', 'timestamp'])
    
# ml-1m
elif dataset_name == 'ml-1m':
    df = pd.read_csv(file_path, sep='::', names=['user_id', 'item_id', 'rating', 'timestamp'], 
                     engine='python')
```

---

## ç‰¹å¾é‡è¦æ€§åˆ†æ

åŸºäº LightGBM æ··åˆç²¾æ’å®éªŒçš„ç‰¹å¾é‡è¦æ€§ï¼š

| æ’å | ç‰¹å¾ | é‡è¦æ€§ | è¯´æ˜ |
|------|------|--------|------|
| 1 | DIN embedding dims | 45% | æ·±åº¦è¯­ä¹‰ç‰¹å¾ |
| 2 | item_popularity | 12% | çƒ­é—¨ç‰©å“æ›´æ˜“è¢«ç‚¹å‡» |
| 3 | user_activity | 10% | æ´»è·ƒç”¨æˆ·è¡Œä¸ºæ¨¡å¼ |
| 4 | item_genre | 8% | ç±»å‹åå¥½ |
| 5 | user_age | 7% | å¹´é¾„å½±å“åå¥½ |
| 6 | time_hour | 6% | æ—¶æ®µå½±å“ |
| 7 | item_year | 5% | å¹´ä»£åå¥½ |
| 8 | å…¶ä»– | 7% | æ€§åˆ«ã€èŒä¸šç­‰ |

**ç»“è®º**: DIN å­¦åˆ°çš„æ·±åº¦åµŒå…¥ç‰¹å¾è´¡çŒ®æœ€å¤§ï¼ŒéªŒè¯äº†æ·±åº¦æ¨¡å‹åœ¨ç‰¹å¾æŠ½å–ä¸Šçš„ä¼˜åŠ¿ã€‚

---

## ç‰¹å¾å·¥ç¨‹æœ€ä½³å®è·µ

### 1. ID ç±»ç‰¹å¾
- ä½¿ç”¨åµŒå…¥å±‚è€Œé one-hot
- é¢„ç•™ padding_idx=0
- åµŒå…¥ç»´åº¦ä¸æ•°æ®è§„æ¨¡åŒ¹é…

### 2. æ•°å€¼ç±»ç‰¹å¾
- åˆ†æ¡¶ç¦»æ•£åŒ–
- æ¡¶è¾¹ç•ŒåŸºäºä¸šåŠ¡å«ä¹‰
- ä¿ç•™ç¼ºå¤±å€¼æ¡¶

### 3. åºåˆ—ç±»ç‰¹å¾
- å·¦ä¾§ paddingï¼ˆä¿ç•™æœ€è¿‘äº¤äº’ï¼‰
- ä½¿ç”¨ mask å±è”½æ— æ•ˆä½ç½®
- åºåˆ—é•¿åº¦ä½œä¸ºè¶…å‚æ•°è°ƒä¼˜

### 4. äº¤å‰ç‰¹å¾
- åœ¨æ··åˆç²¾æ’ä¸­æ˜¾å¼æ„å»º
- ä¾‹: user_activity Ã— item_popularity

```python
# äº¤å‰ç‰¹å¾ç¤ºä¾‹
cross_features = [
    activity * popularity,  # æ´»è·ƒç”¨æˆ·Ã—çƒ­é—¨ç‰©å“
    age * genre,            # å¹´é¾„Ã—ç±»å‹
    gender * genre,         # æ€§åˆ«Ã—ç±»å‹
]
```
